<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Môj CCNA Test</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; color: #333; margin: 0; padding: 20px; }
        .container { max_width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #0056b3; }
        .stats { display: flex; justify-content: space-between; margin-bottom: 20px; font-weight: bold; color: #666; }
        
        .question-box { margin-bottom: 20px; }
        .question-text { font-size: 1.2em; margin-bottom: 15px; font-weight: bold; }
        
        .images-container { text-align: center; margin-bottom: 15px; }
        .images-container img { max-width: 100%; height: auto; border: 1px solid #ddd; margin: 5px; border-radius: 4px; }

        .options-list { list-style: none; padding: 0; }
        .option-item { 
            background: #f9f9f9; border: 1px solid #ddd; padding: 12px; margin-bottom: 8px; 
            cursor: pointer; border-radius: 4px; transition: background 0.2s; 
        }
        .option-item:hover { background: #eef; }
        
        /* Štýly pre vyhodnotenie */
        .option-item.correct { background-color: #d4edda; border-color: #c3e6cb; color: #155724; }
        .option-item.wrong { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .option-item.disabled { pointer-events: none; opacity: 0.8; }

        .explanation { 
            display: none; background: #fff3cd; border: 1px solid #ffeeba; 
            padding: 15px; margin-top: 15px; border-radius: 4px; color: #856404; 
        }

        .controls { display: flex; justify-content: space-between; margin-top: 20px; }
        button { 
            padding: 10px 20px; font-size: 16px; cursor: pointer; 
            background: #007bff; color: white; border: none; border-radius: 4px; 
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>

<div class="container">
    <h1>CCNA 2 - Opakovanie</h1>
    
    <div class="stats">
        <span id="progress">Otázka: 0 / 0</span>
        <span id="score">Skóre: 0</span>
    </div>

    <div id="quiz-area">
        <div class="question-box">
            <div id="q-text" class="question-text">Načítavam test...</div>
            <div id="q-images" class="images-container"></div>
            <ul id="q-options" class="options-list"></ul>
        </div>
        
        <div id="explanation" class="explanation"></div>
    </div>

    <div class="controls">
        <button id="prev-btn" onclick="changeQuestion(-1)" disabled>Popredchádzajúca</button>
        <button id="next-btn" onclick="changeQuestion(1)">Ďalšia</button>
    </div>
</div>

<script>
    let allQuestions = [];
    let currentIndex = 0;
    let score = 0;

    // Načítanie dát
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            allQuestions = data;
            document.getElementById('progress').innerText = `Otázka: 1 / ${allQuestions.length}`;
            loadQuestion(0);
        })
        .catch(error => {
            document.getElementById('q-text').innerText = "Chyba: Nepodarilo sa načítať data.json. Skontrolujte, či je súbor v rovnakom priečinku.";
            console.error(error);
        });

    function loadQuestion(index) {
        if (index < 0 || index >= allQuestions.length) return;
        currentIndex = index;

        const q = allQuestions[index];
        const textField = document.getElementById('q-text');
        const imgContainer = document.getElementById('q-images');
        const optionsList = document.getElementById('q-options');
        const explanationDiv = document.getElementById('explanation');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');

        // Reset
        explanationDiv.style.display = 'none';
        explanationDiv.innerHTML = '';
        imgContainer.innerHTML = '';
        optionsList.innerHTML = '';

        // Text otázky
        textField.innerText = q.question_text;

        // Obrázky (ak sú)
        if (q.images && q.images.length > 0) {
            q.images.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                imgContainer.appendChild(img);
            });
        }

        // Možnosti
        if (q.options && q.options.length > 0) {
            q.options.forEach((opt, i) => {
                const li = document.createElement('li');
                li.className = 'option-item';
                li.innerText = opt;
                li.onclick = () => checkAnswer(li, i, q.correct_options, q.explanation);
                optionsList.appendChild(li);
            });
        } else {
            optionsList.innerHTML = "<li><i>Táto otázka nemá textové možnosti (pravdepodobne iba obrázok). Skúste si odpovedať v hlave.</i></li><br>";
            // Tlačidlo na ukázanie odpovede pre obrázkové otázky
            const showBtn = document.createElement('button');
            showBtn.innerText = "Ukáž správnu odpoveď";
            showBtn.onclick = () => showResult([], q.correct_options, q.explanation);
            optionsList.appendChild(showBtn);
        }

        // Navigácia
        document.getElementById('progress').innerText = `Otázka: ${currentIndex + 1} / ${allQuestions.length}`;
        prevBtn.disabled = currentIndex === 0;
        nextBtn.innerText = (currentIndex === allQuestions.length - 1) ? "Koniec" : "Ďalšia";
    }

    function checkAnswer(element, selectedIndex, correctIndices, explanationText) {
        // Zabránenie viacnásobnému klikaniu
        const options = document.querySelectorAll('.option-item');
        if (element.classList.contains('disabled')) return;

        // Označenie všetkých ako disabled
        options.forEach(opt => opt.classList.add('disabled'));

        const isCorrect = correctIndices.includes(selectedIndex);
        
        if (isCorrect) {
            element.classList.add('correct');
            score++;
            document.getElementById('score').innerText = `Skóre: ${score}`;
        } else {
            element.classList.add('wrong');
            // Zvýrazni správne odpovede
            correctIndices.forEach(idx => {
                if (options[idx]) options[idx].classList.add('correct');
            });
        }

        // Zobraziť vysvetlenie
        showExplanation(explanationText);
    }

    function showResult(dummy, correctIndices, explanationText) {
         // Pre otázky bez možností
         const explanationDiv = document.getElementById('explanation');
         explanationDiv.innerHTML = "<strong>Správne odpovede:</strong> " + correctIndices.map(i => String.fromCharCode(65+i)).join(', ');
         if (explanationText) explanationDiv.innerHTML += "<br><br><strong>Vysvetlenie:</strong> " + explanationText;
         explanationDiv.style.display = 'block';
    }

    function showExplanation(text) {
        const div = document.getElementById('explanation');
        if (text && text.trim() !== "") {
            div.innerHTML = "<strong>Vysvetlenie:</strong> " + text;
            div.style.display = 'block';
        }
    }

    function changeQuestion(direction) {
        loadQuestion(currentIndex + direction);
    }
</script>

</body>
</html>