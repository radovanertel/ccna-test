<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M칪j CCNA Test</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; color: #333; margin: 0; padding: 20px; }
        .container { max_width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #0056b3; }
        
        /* UPRAVEN칄: Stats a horn칠 tla캜idl치 */
        .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .stats { font-weight: bold; color: #666; }
        
        .question-box { margin-bottom: 20px; }
        .question-text { font-size: 1.2em; margin-bottom: 15px; font-weight: bold; }
        
        .images-container { text-align: center; margin-bottom: 15px; }
        .images-container img { 
            max-width: 50%; 
            height: auto; 
            border: 1px solid #ddd; 
            margin: 10px auto; 
            border-radius: 4px; 
            display: block; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer; 
        }
        @media (max-width: 600px) {
            .images-container img { max-width: 90%; }
        }

        .options-list { list-style: none; padding: 0; }
        .option-item { 
            background: #f9f9f9; border: 1px solid #ddd; padding: 12px; margin-bottom: 8px; 
            cursor: pointer; border-radius: 4px; transition: background 0.2s; 
        }
        .option-item:hover { background: #eef; }
        
        .option-item.correct { background-color: #d4edda; border-color: #c3e6cb; color: #155724; }
        .option-item.wrong { background-color: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .option-item.disabled { pointer-events: none; opacity: 0.8; }

        .explanation { 
            display: none; background: #fff3cd; border: 1px solid #ffeeba; 
            padding: 15px; margin-top: 15px; border-radius: 4px; color: #856404; 
        }

        .controls { display: flex; justify-content: space-between; margin-top: 20px; align-items: center; }
        
        button { 
            padding: 10px 20px; font-size: 16px; cursor: pointer; 
            background: #007bff; color: white; border: none; border-radius: 4px; 
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        /* NOV칄: Tla캜idlo pre mie코anie */
        .shuffle-btn {
            background-color: #fd7e14; /* Oran쬺v치 */
            font-size: 14px;
            padding: 8px 15px;
        }
        .shuffle-btn:hover { background-color: #e36d0d; }

        .jump-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            justify-content: center;
        }
        .jump-control select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            min-width: 150px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>CCNA 2 - Test</h1>
    
    <div class="header-bar">
        <div class="stats">
            <span id="progress">Ot치zka: 0 / 0</span> | 
            <span id="score">Sk칩re: 0</span>
        </div>
        <button class="shuffle-btn" onclick="shuffleQuestions()">游 Premie코a콘 ot치zky</button>
    </div>

    <div id="quiz-area">
        <div class="question-box">
            <div id="q-text" class="question-text">Na캜칤tavam test...</div>
            <div id="q-images" class="images-container"></div>
            <ul id="q-options" class="options-list"></ul>
        </div>
        
        <div id="explanation" class="explanation"></div>
    </div>

    <div class="controls">
        <button id="prev-btn" onclick="changeQuestion(-1)" disabled>Popredch치dzaj칰ca</button>
        <button id="next-btn" onclick="changeQuestion(1)">캝al코ia</button>
    </div>

    <div class="jump-control">
        <label for="jump-select">Prejs콘 na:</label>
        <select id="jump-select" onchange="jumpToSelected()">
            <option value="" disabled selected>Na캜칤tavam zoznam...</option>
        </select>
    </div>

</div>

<script>
    let allQuestions = [];
    let currentIndex = 0;
    let score = 0;

    // Na캜칤tanie d치t
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            allQuestions = data;
            document.getElementById('progress').innerText = `Ot치zka: 1 / ${allQuestions.length}`;
            
            populateDropdown();
            loadQuestion(0);
        })
        .catch(error => {
            document.getElementById('q-text').innerText = "Chyba: Nepodarilo sa na캜칤ta콘 data.json. Skontrolujte, 캜i je s칰bor v rovnakom prie캜inku.";
            console.error(error);
        });

    function populateDropdown() {
        const select = document.getElementById('jump-select');
        select.innerHTML = ""; 
        
        allQuestions.forEach((q, index) => {
            const option = document.createElement('option');
            option.value = index;
            // Zobraz칤me poradov칠 캜칤slo v teste (Index+1) a aj p칪vodn칠 ID ot치zky pre orient치ciu
            option.text = `${index + 1}. (P칪vodn치 ot치zka ${q.id})`; 
            select.appendChild(option);
        });
    }

    function loadQuestion(index) {
        if (index < 0 || index >= allQuestions.length) return;
        currentIndex = index;

        const q = allQuestions[index];
        const textField = document.getElementById('q-text');
        const imgContainer = document.getElementById('q-images');
        const optionsList = document.getElementById('q-options');
        const explanationDiv = document.getElementById('explanation');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const select = document.getElementById('jump-select');

        // Reset UI
        explanationDiv.style.display = 'none';
        explanationDiv.innerHTML = '';
        imgContainer.innerHTML = '';
        optionsList.innerHTML = '';

        // Text ot치zky
        textField.innerText = q.question_text;

        // Obr치zky
        if (q.images && q.images.length > 0) {
            q.images.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.onclick = () => window.open(src, '_blank');
                img.title = "Kliknite pre zv칛캜코enie";
                imgContainer.appendChild(img);
            });
        }

        // Mo쬹osti
        if (q.options && q.options.length > 0) {
            q.options.forEach((opt, i) => {
                const li = document.createElement('li');
                li.className = 'option-item';
                li.innerText = opt;
                li.onclick = () => checkAnswer(li, i, q.correct_options, q.explanation);
                optionsList.appendChild(li);
            });
        } else {
            optionsList.innerHTML = "<li><i>T치to ot치zka nem치 textov칠 mo쬹osti.</i></li><br>";
            const showBtn = document.createElement('button');
            showBtn.innerText = "Uk치 spr치vnu odpove캞";
            showBtn.onclick = () => showResult([], q.correct_options, q.explanation);
            optionsList.appendChild(showBtn);
        }

        // Navig치cia
        document.getElementById('progress').innerText = `Ot치zka: ${currentIndex + 1} / ${allQuestions.length}`;
        prevBtn.disabled = currentIndex === 0;
        nextBtn.innerText = (currentIndex === allQuestions.length - 1) ? "Koniec" : "캝al코ia";
        
        select.value = currentIndex;
    }

    function checkAnswer(element, selectedIndex, correctIndices, explanationText) {
        const options = document.querySelectorAll('.option-item');
        if (element.classList.contains('disabled')) return;
        options.forEach(opt => opt.classList.add('disabled'));

        const isCorrect = correctIndices.includes(selectedIndex);
        
        if (isCorrect) {
            element.classList.add('correct');
            score++;
            document.getElementById('score').innerText = `Sk칩re: ${score}`;
        } else {
            element.classList.add('wrong');
            correctIndices.forEach(idx => {
                if (options[idx]) options[idx].classList.add('correct');
            });
        }
        showExplanation(explanationText);
    }

    function showResult(dummy, correctIndices, explanationText) {
         const explanationDiv = document.getElementById('explanation');
         explanationDiv.innerHTML = "<strong>Spr치vne odpovede:</strong> " + correctIndices.map(i => String.fromCharCode(65+i)).join(', ');
         if (explanationText) explanationDiv.innerHTML += "<br><br><strong>Vysvetlenie:</strong> " + explanationText;
         explanationDiv.style.display = 'block';
    }

    function showExplanation(text) {
        const div = document.getElementById('explanation');
        if (text && text.trim() !== "") {
            div.innerHTML = "<strong>Vysvetlenie:</strong> " + text;
            div.style.display = 'block';
        }
    }

    function changeQuestion(direction) {
        loadQuestion(currentIndex + direction);
    }

    function jumpToSelected() {
        const select = document.getElementById('jump-select');
        const selectedIndex = parseInt(select.value);
        loadQuestion(selectedIndex);
    }

    // NOV칄: Funkcia na n치hodn칠 mie코anie (Fisher-Yates)
    function shuffleQuestions() {
        if (!confirm("Naozaj chcete premie코a콘 poradie ot치zok? Va코e aktu치lne sk칩re sa vynuluje.")) {
            return;
        }

        for (let i = allQuestions.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [allQuestions[i], allQuestions[j]] = [allQuestions[j], allQuestions[i]];
        }

        // Reset stavu
        currentIndex = 0;
        score = 0;
        document.getElementById('score').innerText = `Sk칩re: 0`;

        // Aktualiz치cia UI
        populateDropdown(); // D칪le쬴t칠: Aktualizova콘 zoznam, aby sedel s nov칳m porad칤m
        loadQuestion(0);
    }
</script>

</body>
</html>

