<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√¥j CCNA Test</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; color: #333; margin: 0; padding: 20px; }
        .container { max_width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #0056b3; }
        
        /* Hlaviƒçka s tlaƒçidlami */
        .header-bar { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
            flex-wrap: wrap; 
            gap: 10px; 
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        
        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .stats { font-weight: bold; color: #666; font-size: 1.1em; }
        
        .question-box { margin-bottom: 20px; }
        .question-text { font-size: 1.2em; margin-bottom: 10px; font-weight: bold; }
        
        /* N√°poveda na p√¥vodnom mieste */
        .question-hint { color: #e67e22; font-weight: bold; margin-bottom: 15px; font-style: italic; display: block; }

        .images-container { text-align: center; margin-bottom: 15px; }
        .images-container img { 
            max-width: 50%; height: auto; border: 1px solid #ddd; margin: 10px auto; 
            border-radius: 4px; display: block; box-shadow: 0 2px 5px rgba(0,0,0,0.1); cursor: pointer; 
        }
        @media (max-width: 600px) { .images-container img { max-width: 90%; } }

        .options-list { list-style: none; padding: 0; }
        .option-item { 
            background: #f9f9f9; border: 1px solid #ddd; padding: 12px; margin-bottom: 8px; 
            cursor: pointer; border-radius: 4px; transition: background 0.2s; position: relative;
        }
        .option-item:hover { background: #eef; }
        
        .option-item.correct { background-color: #d4edda; border-color: #28a745; color: #155724; font-weight: bold; }
        .option-item.wrong { background-color: #f8d7da; border-color: #dc3545; color: #721c24; opacity: 0.8; }
        
        .option-item.correct::after { content: " ‚úÖ"; float: right; }
        .option-item.wrong::after { content: " ‚ùå"; float: right; }
        
        .option-item.disabled { pointer-events: none; }
        .option-item.finished { opacity: 0.6; pointer-events: none; }

        .explanation { 
            display: none; background: #fff3cd; border: 1px solid #ffeeba; 
            padding: 15px; margin-top: 15px; border-radius: 4px; color: #856404; 
        }

        .controls { display: flex; justify-content: space-between; margin-top: 20px; align-items: center; }
        
        button { 
            padding: 10px 20px; font-size: 16px; cursor: pointer; 
            background: #007bff; color: white; border: none; border-radius: 4px; 
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        /* Farby pre ≈°peci√°lne tlaƒçidl√° */
        .shuffle-q-btn { background-color: #fd7e14; font-size: 14px; padding: 8px 15px; }
        .shuffle-q-btn:hover { background-color: #e36d0d; }

        .shuffle-a-btn { background-color: #6c757d; font-size: 14px; padding: 8px 15px; }
        .shuffle-a-btn:hover { background-color: #5a6268; }

        .jump-control {
            display: flex; align-items: center; gap: 10px; margin-top: 20px; 
            padding-top: 15px; border-top: 1px solid #eee; justify-content: center; 
        }
        .jump-control select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; min-width: 150px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <h1>CCNA 2 - FINAL TEST</h1>
    
    <div class="header-bar">
        <div class="stats">
            <span id="progress">Ot√°zka: 0 / 0</span> | 
            <span id="score">Sk√≥re: 0</span>
        </div>
        
        <div class="header-buttons">
            <button class="shuffle-a-btn" onclick="shuffleAllAnswers()" title="Premie≈°a≈• odpovede (A, B, C...) vo v≈°etk√Ωch ot√°zkach">üîÄ Premie≈°a≈• odpovede</button>
            <button class="shuffle-q-btn" onclick="shuffleQuestions()" title="Zmeni≈• poradie ot√°zok (1, 2, 3...)">üîÄ Premie≈°a≈• ot√°zky</button>
        </div>
    </div>

    <div id="quiz-area">
        <div class="question-box">
            <div id="q-text" class="question-text">Naƒç√≠tavam test...</div>
            
            <div id="q-hint" class="question-hint"></div>
            
            <div class="images-container" id="q-images"></div>
            
            <ul id="q-options" class="options-list"></ul>
        </div>
        
        <div id="explanation" class="explanation"></div>
    </div>

    <div class="controls">
        <button id="prev-btn" onclick="changeQuestion(-1)" disabled>Popredch√°dzaj√∫ca</button>
        <button id="next-btn" onclick="changeQuestion(1)">ƒéal≈°ia</button>
    </div>

    <div class="jump-control">
        <label for="jump-select">Prejs≈• na:</label>
        <select id="jump-select" onchange="jumpToSelected()">
            <option value="" disabled selected>Naƒç√≠tavam zoznam...</option>
        </select>
    </div>

</div>

<script>
    let allQuestions = [];
    let currentIndex = 0;
    let score = 0;
    
    let correctFoundCount = 0;
    let questionFinished = false;

    // Naƒç√≠tanie d√°t
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            allQuestions = data;
            document.getElementById('progress').innerText = `Ot√°zka: 1 / ${allQuestions.length}`;
            populateDropdown();
            loadQuestion(0);
        })
        .catch(error => {
            document.getElementById('q-text').innerText = "Chyba: Nepodarilo sa naƒç√≠ta≈• data.json.";
            console.error(error);
        });

    function populateDropdown() {
        const select = document.getElementById('jump-select');
        select.innerHTML = ""; 
        allQuestions.forEach((q, index) => {
            const option = document.createElement('option');
            option.value = index;
            option.text = `${index + 1}. (P√¥vodn√° ot√°zka ${q.id})`; 
            select.appendChild(option);
        });
    }

    function loadQuestion(index) {
        if (index < 0 || index >= allQuestions.length) return;
        currentIndex = index;
        
        questionFinished = false;
        correctFoundCount = 0;

        const q = allQuestions[index];
        const textField = document.getElementById('q-text');
        const hintField = document.getElementById('q-hint');
        const imgContainer = document.getElementById('q-images');
        const optionsList = document.getElementById('q-options');
        const explanationDiv = document.getElementById('explanation');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const select = document.getElementById('jump-select');

        // UI Reset
        explanationDiv.style.display = 'none';
        explanationDiv.innerHTML = '';
        imgContainer.innerHTML = '';
        optionsList.innerHTML = '';

        // Text ot√°zky
        textField.innerText = q.question_text;

        // Hint (poƒçet odpoved√≠)
        const numCorrect = q.correct_options.length;
        if (q.options.length > 0) {
            if (numCorrect > 1) {
                hintField.innerText = `(Vyberte ${numCorrect} spr√°vne odpovede)`;
            } else {
                hintField.innerText = `(Vyberte 1 spr√°vnu odpoveƒè)`;
            }
        } else {
            hintField.innerText = "";
        }

        // Obr√°zky
        if (q.images && q.images.length > 0) {
            q.images.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.onclick = () => window.open(src, '_blank');
                img.title = "Kliknite pre zv√§ƒç≈°enie";
                imgContainer.appendChild(img);
            });
        }

        // Mo≈ænosti
        if (q.options && q.options.length > 0) {
            q.options.forEach((opt, i) => {
                const li = document.createElement('li');
                li.className = 'option-item';
                li.innerText = opt;
                li.onclick = () => handleOptionClick(li, i, q.correct_options, q.explanation);
                optionsList.appendChild(li);
            });
        } else {
            optionsList.innerHTML = "<li><i>T√°to ot√°zka nem√° textov√© mo≈ænosti.</i></li><br>";
            const showBtn = document.createElement('button');
            showBtn.innerText = "Uk√°≈æ spr√°vnu odpoveƒè";
            showBtn.onclick = () => finishQuestion(false, q.correct_options, q.explanation);
            optionsList.appendChild(showBtn);
        }

        document.getElementById('progress').innerText = `Ot√°zka: ${currentIndex + 1} / ${allQuestions.length}`;
        prevBtn.disabled = currentIndex === 0;
        nextBtn.innerText = (currentIndex === allQuestions.length - 1) ? "Koniec" : "ƒéal≈°ia";
        select.value = currentIndex;
    }

    function handleOptionClick(element, index, correctIndices, explanationText) {
        if (questionFinished || element.classList.contains('disabled')) return;

        const isCorrect = correctIndices.includes(index);

        if (isCorrect) {
            element.classList.add('correct');
            element.classList.add('disabled');
            correctFoundCount++;

            if (correctFoundCount === correctIndices.length) {
                score++;
                document.getElementById('score').innerText = `Sk√≥re: ${score}`;
                finishQuestion(true, correctIndices, explanationText);
            }
        } else {
            element.classList.add('wrong');
            finishQuestion(false, correctIndices, explanationText);
        }
    }

    function finishQuestion(isWin, correctIndices, explanationText) {
        questionFinished = true;
        const options = document.querySelectorAll('.option-item');
        
        options.forEach((opt, idx) => {
            opt.classList.add('disabled'); 
            if (correctIndices.includes(idx) && !opt.classList.contains('correct')) {
                opt.classList.add('correct');
                opt.style.opacity = "0.7"; 
            } else if (!opt.classList.contains('correct') && !opt.classList.contains('wrong')) {
                opt.classList.add('finished');
            }
        });

        showExplanation(explanationText);
    }

    function showExplanation(text) {
        const div = document.getElementById('explanation');
        if (text && text.trim() !== "") {
            div.innerHTML = "<strong>Vysvetlenie:</strong> " + text;
            div.style.display = 'block';
        } else {
            div.innerHTML = "<strong>Koniec ot√°zky.</strong>";
            div.style.display = 'block';
        }
    }

    function changeQuestion(direction) {
        loadQuestion(currentIndex + direction);
    }

    function jumpToSelected() {
        const select = document.getElementById('jump-select');
        const selectedIndex = parseInt(select.value);
        loadQuestion(selectedIndex);
    }

    // Funkcia na mie≈°anie poradia ot√°zok
    function shuffleQuestions() {
        if (!confirm("Naozaj chcete premie≈°a≈• poradie ot√°zok? Va≈°e aktu√°lne sk√≥re sa vynuluje.")) return;

        for (let i = allQuestions.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [allQuestions[i], allQuestions[j]] = [allQuestions[j], allQuestions[i]];
        }

        currentIndex = 0;
        score = 0;
        document.getElementById('score').innerText = `Sk√≥re: 0`;
        populateDropdown();
        loadQuestion(0);
    }

    // NOV√â: Funkcia na mie≈°anie odpoved√≠ GLOB√ÅLNE (vo v≈°etk√Ωch ot√°zkach)
    function shuffleAllAnswers() {
        if (!confirm("Naozaj chcete premie≈°a≈• poradie odpoved√≠ (A, B, C...) vo v≈°etk√Ωch ot√°zkach?")) return;

        allQuestions.forEach(q => {
            if (!q.options || q.options.length < 2) return;

            // 1. Sp√°rujeme text a info o spr√°vnosti
            let combined = q.options.map((opt, i) => ({
                text: opt,
                isCorrect: q.correct_options.includes(i)
            }));

            // 2. Zamie≈°ame (Fisher-Yates)
            for (let i = combined.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [combined[i], combined[j]] = [combined[j], combined[i]];
            }

            // 3. Vr√°time sp√§≈• do ≈°trukt√∫ry
            q.options = combined.map(obj => obj.text);
            q.correct_options = [];
            combined.forEach((obj, index) => {
                if (obj.isCorrect) {
                    q.correct_options.push(index);
                }
            });
        });

        // 4. Znova naƒç√≠tame aktu√°lnu ot√°zku, aby sa zmena prejavila hneƒè
        loadQuestion(currentIndex);
    }
</script>

</body>
</html>
