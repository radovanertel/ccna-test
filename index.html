<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√¥j CCNA Test</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f9; color: #333; margin: 0; padding: 20px; }
        .container { max_width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #0056b3; }
        
        .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
        .stats { font-weight: bold; color: #666; }
        
        .question-box { margin-bottom: 20px; }
        .question-text { font-size: 1.2em; margin-bottom: 15px; font-weight: bold; }
        
        .images-container { text-align: center; margin-bottom: 15px; }
        .images-container img { 
            max-width: 50%; 
            height: auto; 
            border: 1px solid #ddd; 
            margin: 10px auto; 
            border-radius: 4px; 
            display: block; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer; 
        }
        @media (max-width: 600px) { .images-container img { max-width: 90%; } }

        .options-list { list-style: none; padding: 0; }
        .option-item { 
            background: #f9f9f9; border: 1px solid #ddd; padding: 12px; margin-bottom: 8px; 
            cursor: pointer; border-radius: 4px; transition: background 0.2s, border-color 0.2s; 
            position: relative;
        }
        .option-item:hover { background: #eef; }
        
        /* NOV√â: ≈†t√Ωl pre oznaƒçen√∫ odpoveƒè (pred kontrolou) */
        .option-item.selected { 
            background-color: #e7f1ff; 
            border-color: #007bff; 
            color: #0056b3;
            font-weight: bold;
        }

        /* ≈†t√Ωly po vyhodnoten√≠ */
        .option-item.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
        .option-item.wrong { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
        
        /* Zv√Ωraznenie toho, ƒço pou≈æ√≠vateƒæ vybral zle */
        .option-item.wrong::after { content: " ‚ùå"; float: right; }
        /* Zv√Ωraznenie toho, ƒço je spr√°vne */
        .option-item.correct::after { content: " ‚úÖ"; float: right; }

        .option-item.disabled { pointer-events: none; }

        .explanation { 
            display: none; background: #fff3cd; border: 1px solid #ffeeba; 
            padding: 15px; margin-top: 15px; border-radius: 4px; color: #856404; 
        }

        .controls { display: flex; justify-content: space-between; margin-top: 20px; align-items: center; }
        
        button { 
            padding: 10px 20px; font-size: 16px; cursor: pointer; 
            background: #007bff; color: white; border: none; border-radius: 4px; 
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        .shuffle-btn { background-color: #fd7e14; font-size: 14px; padding: 8px 15px; }
        .shuffle-btn:hover { background-color: #e36d0d; }

        /* NOV√â: Tlaƒçidlo Skontrolova≈• */
        .check-btn {
            background-color: #28a745;
            width: 100%;
            margin-top: 10px;
            font-weight: bold;
            display: none; /* Zobraz√≠ sa len keƒè s√∫ mo≈ænosti */
        }
        .check-btn:hover { background-color: #218838; }

        .jump-control {
            display: flex; align-items: center; gap: 10px; margin-top: 20px; 
            padding-top: 15px; border-top: 1px solid #eee; justify-content: center; 
        }
        .jump-control select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; min-width: 150px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <h1>CCNA 2 - Test</h1>
    
    <div class="header-bar">
        <div class="stats">
            <span id="progress">Ot√°zka: 0 / 0</span> | 
            <span id="score">Sk√≥re: 0</span>
        </div>
        <button class="shuffle-btn" onclick="shuffleQuestions()">üîÄ Premie≈°a≈• ot√°zky</button>
    </div>

    <div id="quiz-area">
        <div class="question-box">
            <div id="q-text" class="question-text">Naƒç√≠tavam test...</div>
            <div id="q-images" class="images-container"></div>
            <ul id="q-options" class="options-list"></ul>
            
            <button id="check-btn" class="check-btn" onclick="validateAnswer()">Skontrolova≈• odpoveƒè</button>
        </div>
        
        <div id="explanation" class="explanation"></div>
    </div>

    <div class="controls">
        <button id="prev-btn" onclick="changeQuestion(-1)" disabled>Popredch√°dzaj√∫ca</button>
        <button id="next-btn" onclick="changeQuestion(1)">ƒéal≈°ia</button>
    </div>

    <div class="jump-control">
        <label for="jump-select">Prejs≈• na:</label>
        <select id="jump-select" onchange="jumpToSelected()">
            <option value="" disabled selected>Naƒç√≠tavam zoznam...</option>
        </select>
    </div>

</div>

<script>
    let allQuestions = [];
    let currentIndex = 0;
    let score = 0;
    let isAnswered = false; // Stav, ƒçi u≈æ bola ot√°zka vyhodnoten√°

    // Naƒç√≠tanie d√°t
    fetch('data.json')
        .then(response => response.json())
        .then(data => {
            allQuestions = data;
            document.getElementById('progress').innerText = `Ot√°zka: 1 / ${allQuestions.length}`;
            populateDropdown();
            loadQuestion(0);
        })
        .catch(error => {
            document.getElementById('q-text').innerText = "Chyba: Nepodarilo sa naƒç√≠ta≈• data.json. Skontrolujte, ƒçi je s√∫bor v rovnakom prieƒçinku.";
            console.error(error);
        });

    function populateDropdown() {
        const select = document.getElementById('jump-select');
        select.innerHTML = ""; 
        allQuestions.forEach((q, index) => {
            const option = document.createElement('option');
            option.value = index;
            option.text = `${index + 1}. (P√¥vodn√° ot√°zka ${q.id})`; 
            select.appendChild(option);
        });
    }

    function loadQuestion(index) {
        if (index < 0 || index >= allQuestions.length) return;
        currentIndex = index;
        isAnswered = false; // Reset stavu

        const q = allQuestions[index];
        const textField = document.getElementById('q-text');
        const imgContainer = document.getElementById('q-images');
        const optionsList = document.getElementById('q-options');
        const explanationDiv = document.getElementById('explanation');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const prevBtn = document.getElementById('prev-btn');
        const select = document.getElementById('jump-select');

        // Reset UI
        explanationDiv.style.display = 'none';
        explanationDiv.innerHTML = '';
        imgContainer.innerHTML = '';
        optionsList.innerHTML = '';
        checkBtn.style.display = 'none'; // Skry≈• tlaƒçidlo kontroly

        // Text
        textField.innerText = q.question_text;

        // Obr√°zky
        if (q.images && q.images.length > 0) {
            q.images.forEach(src => {
                const img = document.createElement('img');
                img.src = src;
                img.onclick = () => window.open(src, '_blank');
                img.title = "Kliknite pre zv√§ƒç≈°enie";
                imgContainer.appendChild(img);
            });
        }

        // Mo≈ænosti
        if (q.options && q.options.length > 0) {
            q.options.forEach((opt, i) => {
                const li = document.createElement('li');
                li.className = 'option-item';
                li.innerText = opt;
                // ZMENA: Kliknutie len prep√≠na v√Ωber (toggleSelection)
                li.onclick = () => toggleSelection(li);
                li.dataset.index = i; // Ulo≈æ√≠me si index do elementu
                optionsList.appendChild(li);
            });
            checkBtn.style.display = 'block'; // Uk√°za≈• tlaƒçidlo "Skontrolova≈•"
            checkBtn.innerText = "Skontrolova≈• odpoveƒè";
            checkBtn.disabled = false;
        } else {
            // Pre ot√°zky bez textov√Ωch mo≈ænost√≠
            optionsList.innerHTML = "<li><i>T√°to ot√°zka nem√° textov√© mo≈ænosti.</i></li><br>";
            checkBtn.style.display = 'block';
            checkBtn.innerText = "Uk√°≈æ spr√°vnu odpoveƒè (len obr√°zok)";
        }

        document.getElementById('progress').innerText = `Ot√°zka: ${currentIndex + 1} / ${allQuestions.length}`;
        prevBtn.disabled = currentIndex === 0;
        nextBtn.innerText = (currentIndex === allQuestions.length - 1) ? "Koniec" : "ƒéal≈°ia";
        select.value = currentIndex;
    }

    // NOV√â: Funkcia na prep√≠nanie v√Ωberu (modr√© oznaƒçenie)
    function toggleSelection(element) {
        if (isAnswered) return; // Ak u≈æ je vyhodnoten√©, nedovoƒæ zmeny
        element.classList.toggle('selected');
    }

    // NOV√â: Funkcia na vyhodnotenie odpovede
    function validateAnswer() {
        if (isAnswered) return; // Poistka
        
        const q = allQuestions[currentIndex];
        const options = document.querySelectorAll('.option-item');
        const checkBtn = document.getElementById('check-btn');
        
        // Z√≠skame indexy, ktor√© pou≈æ√≠vateƒæ oznaƒçil
        let userSelectedIndices = [];
        options.forEach((opt, index) => {
            if (opt.classList.contains('selected')) {
                userSelectedIndices.push(index);
            }
        });

        // Kontrola, ƒçi pou≈æ√≠vateƒæ v√¥bec nieƒço vybral (ak ot√°zka m√° mo≈ænosti)
        if (q.options.length > 0 && userSelectedIndices.length === 0) {
            alert("Pros√≠m, vyber aspo≈à jednu mo≈ænos≈•.");
            return;
        }

        isAnswered = true; // Zablokujeme ƒèal≈°ie zmeny
        checkBtn.disabled = true; // Vypneme tlaƒçidlo

        let isAllCorrect = true;

        // PRECH√ÅDZANIE MO≈ΩNOST√ç A FARBENIE
        options.forEach((opt, index) => {
            opt.classList.remove('selected'); // Odstr√°nime modr√© oznaƒçenie
            opt.classList.add('disabled'); // Zablokujeme klikanie

            const isReallyCorrect = q.correct_options.includes(index);
            const userSelectedThis = userSelectedIndices.includes(index);

            if (isReallyCorrect) {
                // Je to spr√°vna odpoveƒè -> v≈ædy bude zelen√°
                opt.classList.add('correct');
                
                // Ak bola spr√°vna a pou≈æ√≠vateƒæ ju NEVYBRAL, tak chyba
                if (!userSelectedThis) {
                    isAllCorrect = false;
                }
            } else {
                // Je to nespr√°vna odpoveƒè
                if (userSelectedThis) {
                    // Pou≈æ√≠vateƒæ ju vybral -> chyba (ƒçerven√°)
                    opt.classList.add('wrong');
                    isAllCorrect = false;
                }
            }
        });

        // √öprava sk√≥re (Len ak je v≈°etko 100% spr√°vne)
        if (q.options.length > 0) {
            if (isAllCorrect) {
                score++;
                document.getElementById('score').innerText = `Sk√≥re: ${score}`;
            }
        }

        // Zobrazenie vysvetlenia
        showExplanation(q.explanation);
    }

    function showExplanation(text) {
        const div = document.getElementById('explanation');
        // V≈ædy uk√°≈æeme vysvetlenie, ak existuje, alebo aspo≈à spr√°vne odpovede v texte
        // (Tu u≈æ to vidia farebne, ale vysvetlenie je bonus)
        if (text && text.trim() !== "") {
            div.innerHTML = "<strong>Vysvetlenie:</strong> " + text;
            div.style.display = 'block';
        }
    }

    function changeQuestion(direction) {
        loadQuestion(currentIndex + direction);
    }

    function jumpToSelected() {
        const select = document.getElementById('jump-select');
        const selectedIndex = parseInt(select.value);
        loadQuestion(selectedIndex);
    }

    function shuffleQuestions() {
        if (!confirm("Naozaj chcete premie≈°a≈• poradie ot√°zok? Va≈°e aktu√°lne sk√≥re sa vynuluje.")) return;

        for (let i = allQuestions.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [allQuestions[i], allQuestions[j]] = [allQuestions[j], allQuestions[i]];
        }

        currentIndex = 0;
        score = 0;
        document.getElementById('score').innerText = `Sk√≥re: 0`;
        populateDropdown();
        loadQuestion(0);
    }
</script>

</body>
</html>
